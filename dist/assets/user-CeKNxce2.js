import{e as n,j as o}from"./index-DCRMDEnN.js";import{r as m}from"./react-dom-B_KBoKIY.js";import{s as u}from"./index-D8YrEZpJ.js";import{P as f}from"./ProCard-Dqfv741k.js";import{P as g,b as x}from"./Table-DyPCT7V2.js";import{B as c}from"./button-DEnRpW9g.js";import"./index-CDqw0lfA.js";import"./index-Ctq1ZWD9.js";import"./index-CmozH8WR.js";import"./FileOutlined-l9Qrf-hC.js";import"./progress-Cp_dByrN.js";import"./index-BvlifVVu.js";import"./index-CoWpGy66.js";import"./FolderOutlined-DdSHhABZ.js";function w(){const[a,d]=u.useMessage(),[r,s]=m.useState([]);m.useEffect(()=>{fetch(n.API_URL+"/api/v1/auth/users",{method:"GET",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("SESSION")||""}}).then(e=>{e.ok&&e.json().then(t=>{s(t)})})},[]);const l=e=>{fetch(n.API_URL+"/api/v1/auth/user?id="+e,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("SESSION")||""}}).then(async t=>{if(!t.ok&&t.status===401){const i=await t.json();i.msg&&(a.destroy(),a.error(i.msg))}return t.json()}).then(t=>{t.status===0?(a.success("删除用户成功"),s(r.filter(i=>i.id!==e)),s(r.filter(i=>i.id!==e))):a.error(t.msg)})},p=e=>{a.info(`正在编辑 ${e.name}`)},h=[{title:"ID",dataIndex:"id",key:"id"},{title:"用户名",dataIndex:"name",key:"name"},{title:"邮箱",dataIndex:"mail",key:"mail"},{title:"操作",key:"action",valueType:"option",render:(e,t)=>o.jsxs(o.Fragment,{children:[o.jsx(c,{onClick:()=>{p(t)},style:{marginRight:8},children:"编辑"}),o.jsx(x,{title:"确定要删除用户吗?",onConfirm:()=>{l(t.id)},children:o.jsx(c,{children:"删除"})})]})}];return o.jsxs(o.Fragment,{children:[d,o.jsx(f,{children:o.jsx(g,{columns:h,dataSource:r,rowKey:"id",toolbar:{style:{padding:0,height:0}},pagination:{showQuickJumper:!0,pageSize:5},search:!1})})]})}export{w as default};
