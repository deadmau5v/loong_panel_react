import{j as e,C as u}from"./index-DCRMDEnN.js";import{P as j}from"./progress-Cp_dByrN.js";import{D as a}from"./index-UP3Xbl4Q.js";import{r as i}from"./react-dom-B_KBoKIY.js";import{C as p}from"./index-DKI7GbiO.js";import{F as _}from"./index-CjouklKV.js";const h=["B","KB","MB","GB"];function n(r,s=!0){let t=0;for(;r>=1024&&t<h.length-1;)r/=1024,t++;return r.toFixed(2)+(s?h[t]:"")}function f(r){return e.jsxs(e.Fragment,{children:[e.jsxs(a.Item,{label:"平均负载",children:[r.average_load,"%"]}),e.jsxs(a.Item,{label:"最近1分钟",children:[r.load1m,"%"]}),e.jsxs(a.Item,{label:"最近5分钟",children:[r.load5m,"%"]}),e.jsxs(a.Item,{label:"最近15分钟",children:[r.load15m,"%"]})]})}function g(r){return e.jsxs(e.Fragment,{children:[e.jsxs(a.Item,{label:"平均负载",children:[r.cpu_usage.toFixed(2),"%"]}),e.jsxs(a.Item,{label:"核心数量",children:[r.cpu_number," * ",r.cpu_cores," Core"]}),e.jsxs(a.Item,{label:"核心频率",children:[r.cpu_mhz," MHz"]}),e.jsx(a.Item,{label:"核心架构",children:r.cpu_arch})]})}function I(r){return e.jsxs(e.Fragment,{children:[e.jsxs(a.Item,{label:"内存占用",children:[r.memory_usage,"%"]}),e.jsx(a.Item,{label:"内存容量",children:n(r.ram_total)}),e.jsxs(a.Item,{label:"内存频率",children:[r.ram_mhz," MHz"]}),e.jsx(a.Item,{label:"交换内存",children:n(r.ram_swap)})]})}function b(r){return r.disks=r.disks.slice(0,2),e.jsxs(e.Fragment,{children:[e.jsxs(a.Item,{label:"磁盘占用",children:[r.disk_usage,"%"]}),e.jsx(a.Item,{label:"磁盘容量",children:n(r.disk_total)}),r.disks.map((s,t)=>e.jsxs(a.Item,{label:s.FileSystem,children:[n(s.UsedMemory,!1)," / ",n(s.MaxMemory)]},t))]})}function m({title:r,status:s}){let t=0,l=e.jsx(e.Fragment,{});switch(r){case"Load":t=s.average_load,l=f(s);break;case"CPU":t=Math.floor(s.cpu_usage*100)/100,l=g(s);break;case"RAM":t=Math.floor(s.memory_usage*100)/100,l=I(s);break;case"Disk":t=Math.floor(s.disk_usage*100)/100,l=b(s);break}return e.jsx(e.Fragment,{children:e.jsxs("div",{id:"Chart",children:[e.jsx("span",{children:r}),e.jsx(j,{type:"dashboard",percent:t,strokeColor:"#ff8383"}),e.jsx(a,{size:"small",column:1,className:"ChartDescriptions",children:l})]})})}function S(){const r=i.useContext(u),s=`${r==null?void 0:r.API_URL}/api/v1/status/system_status`,t=2e3,[l,x]=i.useState({disk_usage:0,average_load:0,memory_usage:0,cpu_usage:0,load1m:0,load5m:0,load15m:0,cpu_number:0,cpu_cores:0,cpu_mhz:0,cpu_arch:0,ram_total:0,ram_used_free:[0,0],ram_mhz:0,ram_swap:0,disk_total:0,disks:[]}),c=async()=>{const o=await fetch(s,{method:"GET",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("SESSION")||""}});if(o.ok){const d=await o.json();console.log(d),x(d)}};return i.useEffect(()=>{const o=setInterval(c,t);return()=>{clearInterval(o)}},[s]),i.useEffect(()=>{c()},[]),e.jsx(e.Fragment,{children:e.jsx(p,{id:"Charts",className:"card",title:"性能监控",children:e.jsxs(_,{justify:"space-evenly",align:"center",children:[e.jsx(m,{title:"Load",status:l}),e.jsx(m,{title:"CPU",status:l}),e.jsx(m,{title:"RAM",status:l}),e.jsx(m,{title:"Disk",status:l})]})})})}export{S as default};
