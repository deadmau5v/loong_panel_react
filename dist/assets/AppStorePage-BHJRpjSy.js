import{r as oe,s as te,q as M,p as se,Q as re,x as U,k as P,S as W,U as ne,w as le,W as ae,X as ce,Y as ie,Z as L,$ as de,j as a,a0 as ge,e as f}from"./index-DCRMDEnN.js";import{r as i}from"./react-dom-B_KBoKIY.js";import{s as ue}from"./index-D8YrEZpJ.js";import{P as me}from"./ProCard-Dqfv741k.js";import{C as pe}from"./index-DKI7GbiO.js";import{G as H,B as k}from"./index-CmozH8WR.js";import{W as he}from"./index-CDqw0lfA.js";import{B as v}from"./button-DEnRpW9g.js";const Ce=e=>{const{paddingXXS:l,lineWidth:o,tagPaddingHorizontal:t,componentCls:r,calc:s}=e,c=s(t).sub(o).equal(),n=s(l).sub(o).equal();return{[r]:Object.assign(Object.assign({},te(e)),{display:"inline-block",height:"auto",marginInlineEnd:e.marginXS,paddingInline:c,fontSize:e.tagFontSize,lineHeight:e.tagLineHeight,whiteSpace:"nowrap",background:e.defaultBg,border:`${M(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadiusSM,opacity:1,transition:`all ${e.motionDurationMid}`,textAlign:"start",position:"relative",[`&${r}-rtl`]:{direction:"rtl"},"&, a, a:hover":{color:e.defaultColor},[`${r}-close-icon`]:{marginInlineStart:n,fontSize:e.tagIconSize,color:e.colorTextDescription,cursor:"pointer",transition:`all ${e.motionDurationMid}`,"&:hover":{color:e.colorTextHeading}},[`&${r}-has-color`]:{borderColor:"transparent",[`&, a, a:hover, ${e.iconCls}-close, ${e.iconCls}-close:hover`]:{color:e.colorTextLightSolid}},"&-checkable":{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",[`&:not(${r}-checkable-checked):hover`]:{color:e.colorPrimary,backgroundColor:e.colorFillSecondary},"&:active, &-checked":{color:e.colorTextLightSolid},"&-checked":{backgroundColor:e.colorPrimary,"&:hover":{backgroundColor:e.colorPrimaryHover}},"&:active":{backgroundColor:e.colorPrimaryActive}},"&-hidden":{display:"none"},[`> ${e.iconCls} + span, > span + ${e.iconCls}`]:{marginInlineStart:c}}),[`${r}-borderless`]:{borderColor:"transparent",background:e.tagBorderlessBg}}},E=e=>{const{lineWidth:l,fontSizeIcon:o,calc:t}=e,r=e.fontSizeSM;return se(e,{tagFontSize:r,tagLineHeight:M(t(e.lineHeightSM).mul(r).equal()),tagIconSize:t(o).sub(t(l).mul(2)).equal(),tagPaddingHorizontal:8,tagBorderlessBg:e.defaultBg})},_=e=>({defaultBg:new re(e.colorFillQuaternary).onBackground(e.colorBgContainer).toHexString(),defaultColor:e.colorText}),F=oe("Tag",e=>{const l=E(e);return Ce(l)},_);var fe=function(e,l){var o={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&l.indexOf(t)<0&&(o[t]=e[t]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,t=Object.getOwnPropertySymbols(e);r<t.length;r++)l.indexOf(t[r])<0&&Object.prototype.propertyIsEnumerable.call(e,t[r])&&(o[t[r]]=e[t[r]]);return o};const be=i.forwardRef((e,l)=>{const{prefixCls:o,style:t,className:r,checked:s,onChange:c,onClick:n}=e,u=fe(e,["prefixCls","style","className","checked","onChange","onClick"]),{getPrefixCls:b,tag:m}=i.useContext(U),S=y=>{c==null||c(!s),n==null||n(y)},p=b("tag",o),[j,$,g]=F(p),I=P(p,`${p}-checkable`,{[`${p}-checkable-checked`]:s},m==null?void 0:m.className,r,$,g);return j(i.createElement("span",Object.assign({},u,{ref:l,style:Object.assign(Object.assign({},t),m==null?void 0:m.style),className:I,onClick:S})))}),Se=e=>ne(e,(l,o)=>{let{textColor:t,lightBorderColor:r,lightColor:s,darkColor:c}=o;return{[`${e.componentCls}${e.componentCls}-${l}`]:{color:t,background:s,borderColor:r,"&-inverse":{color:e.colorTextLightSolid,background:c,borderColor:c},[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}}),ye=W(["Tag","preset"],e=>{const l=E(e);return Se(l)},_);function ve(e){return typeof e!="string"?e:e.charAt(0).toUpperCase()+e.slice(1)}const x=(e,l,o)=>{const t=ve(o);return{[`${e.componentCls}${e.componentCls}-${l}`]:{color:e[`color${o}`],background:e[`color${t}Bg`],borderColor:e[`color${t}Border`],[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}},xe=W(["Tag","status"],e=>{const l=E(e);return[x(l,"success","Success"),x(l,"processing","Info"),x(l,"error","Error"),x(l,"warning","Warning")]},_);var je=function(e,l){var o={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&l.indexOf(t)<0&&(o[t]=e[t]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,t=Object.getOwnPropertySymbols(e);r<t.length;r++)l.indexOf(t[r])<0&&Object.prototype.propertyIsEnumerable.call(e,t[r])&&(o[t[r]]=e[t[r]]);return o};const $e=i.forwardRef((e,l)=>{const{prefixCls:o,className:t,rootClassName:r,style:s,children:c,icon:n,color:u,onClose:b,bordered:m=!0,visible:S}=e,p=je(e,["prefixCls","className","rootClassName","style","children","icon","color","onClose","bordered","visible"]),{getPrefixCls:j,direction:$,tag:g}=i.useContext(U),[I,y]=i.useState(!0),q=le(p,["closeIcon","closable"]);i.useEffect(()=>{S!==void 0&&y(S)},[S]);const N=ae(u),z=ce(u),O=N||z,D=Object.assign(Object.assign({backgroundColor:u&&!O?u:void 0},g==null?void 0:g.style),s),d=j("tag",o),[X,G,Q]=F(d),Y=P(d,g==null?void 0:g.className,{[`${d}-${u}`]:O,[`${d}-has-color`]:u&&!O,[`${d}-hidden`]:!I,[`${d}-rtl`]:$==="rtl",[`${d}-borderless`]:!m},t,r,G,Q),B=C=>{C.stopPropagation(),b==null||b(C),!C.defaultPrevented&&y(!1)},[,Z]=ie(L(e),L(g),{closable:!1,closeIconRender:C=>{const ee=i.createElement("span",{className:`${d}-close-icon`,onClick:B},C);return de(C,ee,h=>({onClick:R=>{var T;(T=h==null?void 0:h.onClick)===null||T===void 0||T.call(h,R),B(R)},className:P(h==null?void 0:h.className,`${d}-close-icon`)}))}}),J=typeof p.onClick=="function"||c&&c.type==="a",A=n||null,K=A?i.createElement(i.Fragment,null,A,c&&i.createElement("span",null,c)):c,w=i.createElement("span",Object.assign({},q,{ref:l,className:Y,style:D}),K,Z,N&&i.createElement(ye,{key:"preset",prefixCls:d}),z&&i.createElement(xe,{key:"status",prefixCls:d}));return X(J?i.createElement(he,{component:"Tag"},w):w)}),V=$e;V.CheckableTag=be;function Be(){const[e,l]=i.useState([]),[o,t]=ue.useMessage(),r=()=>{fetch(f.API_URL+"/api/v1/appstore/apps",{method:"GET",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("SESSION")||""}}).then(s=>s.json()).then(s=>{s.status===0?l(s.data):console.log(s.msg)})};return i.useEffect(()=>{r()},[]),a.jsxs(a.Fragment,{children:[t,a.jsx(me,{children:e.map((s,c)=>a.jsx(pe,{style:{marginBottom:16},title:s.name,extra:a.jsx(a.Fragment,{children:a.jsxs(H,{children:[a.jsx(k,{status:s.is_install?"success":"error",text:s.is_install?"已安装":"未安装"}),a.jsx(k,{status:s.is_running?"success":"error",text:s.is_running?"运行中":"未运行"})]})}),children:a.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[a.jsx(ge,{src:f.API_URL+"/script/icons/"+s.icon,size:100,shape:"circle",style:{marginRight:16}}),a.jsxs("div",{children:[a.jsxs("p",{children:["版本: ",s.is_install?s.version:"未安装"]}),a.jsxs("p",{children:["标签: ",s.tags.map(n=>a.jsx(V,{color:"blue",children:n},n))]}),a.jsxs(H,{children:[a.jsx(v,{disabled:s.is_install,onClick:()=>{o.loading("请勿关闭或多次点击！正在安装..."),fetch(f.API_URL+"/api/v1/appstore/app?name="+s.name,{method:"POST",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("SESSION")||""}}).then(n=>n.json()).then(n=>{o.destroy(),n.status!==0?o.error(n.msg):(o.success("安装成功"),r())})},children:"安装"}),a.jsx(v,{disabled:!s.is_install,onClick:()=>{o.loading("正在卸载"),fetch(f.API_URL+"/api/v1/appstore/app?name="+s.name,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("SESSION")||""}}).then(n=>n.json()).then(n=>{o.destroy(),n.status!==0?o.error(n.msg):(o.success("卸载成功"),r())})},children:"卸载"}),a.jsx(v,{disabled:!s.is_install||s.is_running,onClick:()=>{o.loading("正在启动"),fetch(f.API_URL+"/api/v1/appstore/app/start?name="+s.name,{method:"POST",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("SESSION")||""}}).then(n=>n.json()).then(n=>{o.destroy(),n.status!==0?o.error(n.msg):(o.success("启动成功"),r())})},children:"启动"}),a.jsx(v,{disabled:!s.is_install||!s.is_running,onClick:()=>{o.loading("正在停止"),fetch(f.API_URL+"/api/v1/appstore/app/stop?name="+s.name,{method:"POST",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("SESSION")||""}}).then(n=>n.json()).then(n=>{o.destroy(),n.status!==0?o.error(n.msg):(o.success("停止成功"),r())})},children:"停止"})]})]})]})},c))})]})}export{Be as default};
